# This file is auto-generated by openmediavault (https://www.openmediavault.org)
# WARNING: Do not edit this file, your changes will get lost.

# nextcloud
# 
version: '3.2'

services:
  db:
    image: postgres
    restart: always
    volumes:
      - ./db:/var/lib/postgresql/data
    env_file: nextcloud.env
    secrets:
      - postgres_db
      - postgres_password
      - postgres_user
    networks:
      nextcloud:
    #user: ${PUID}:${PGID}
    
  app:
    container_name: nextcloud
    image: nextcloud
    restart: always
    volumes:
      - ./nextcloud:/var/www/html
    env_file: nextcloud.env
    depends_on:
      - db
    #user: ${PUID}:${PGID}
    secrets:
      - nextcloud_admin_password
      - nextcloud_admin_user
      - postgres_db
      - postgres_password
      - postgres_user
    networks: 
      swag:
      nextcloud:

networks: 
  swag:
    external: true
  nextcloud:

secrets:
  nextcloud_admin_password:
    file: ./nextcloud_admin_password.txt # put admin password in this file
  nextcloud_admin_user:
    file: ./nextcloud_admin_user.txt # put admin username in this file nextcloud
  postgres_db:
    file: ./nextcloud_admin_user.txt # put postgresql db name in this file
  postgres_password:
    file: ./postgres_password.txt # put postgresql password in this file
  postgres_user:
    file: ./nextcloud_admin_user.txt # put postgresql username in this file
