# This file is auto-generated by openmediavault (https://www.openmediavault.org)
# WARNING: Do not edit this file, your changes will get lost.

# koel
# Music-Server => with Postgres not possible to login with provided user. Works Now is sometimes a bit flucky. What seemed to help was: docker exec --user www-data -it koel-koel-1 php artisan koel:init --no-assets; docker exec --user www-data -it koel-koel-1 php artisan koel:admin:change-password
version: '3'
services:
  koel:
    container_name: koel
    image: phanan/koel
    depends_on:
      - database
    #ports:
     # - 1340:80
    volumes:
      - /srv/mergerfs/NAS/Media/Music:/music
      - ./covers:/var/www/html/public/img/covers
      - ./search_index:/var/www/html/storage/search-indexes
    env_file: koel.env
    restart: unless-stopped
    networks: 
      koel:
      swag: 
      
  database:
    container_name: koel-db
    image: mysql/mysql-server:5.7
    volumes:
      - ./mysql_db:/var/lib/mysql
    env_file: koel.env
    environment:
      - MYSQL_ROOT_PASSWORD=${MYSQL_ROOT_PASSWORD}
      - MYSQL_DATABASE=${DB_DATABASE}
      - MYSQL_USER=${DB_USERNAME}
      - MYSQL_PASSWORD=${DB_PASSWORD}
    networks: 
      koel:
      
networks: 
  koel:
  swag: 
    external: true
