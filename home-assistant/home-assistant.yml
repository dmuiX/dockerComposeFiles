# This file is auto-generated by openmediavault (https://www.openmediavault.org)
# WARNING: Do not edit this file, your changes will get lost.

# home-assistant
# 
# https://iotechonline.com/home-assistant-install-with-docker-compose/

version: '3'
services:
  home-assistant:
    container_name: home-assistant
    image: homeassistant/home-assistant
    volumes:
      - ./home-assistant-config:/config
      - /etc/localtime:/etc/localtime:ro
      - /run/dbus:/run/dbus:ro
    #network_mode: host
    restart: unless-stopped
    depends_on:
      - mariadb
      - mosquitto
    env_file: home-assistant.env
    labels:
      - "com.centurylinklabs.watchtower.enable=true"
    networks:
      swag:
      home-assistant:
      #macvlan0:
      #   ipv4_address: 192.168.1.225 # adjust the IP address as needed; this is the IP to reach ioBroker
          
  mariadb:
    image: linuxserver/mariadb
    container_name: mariadb
    restart: unless-stopped
    environment:
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
      MYSQL_DATABASE: ha_db
      MYSQL_USER: homeassistant
      MYSQL_PASSWORD: ${HA_MYSQL_PASSWORD}
      PUID: ${PUID}
      PGID: ${PGID}
    volumes:
      - ./mariadb:/config
    ports:
      - "3306:3306"
    env_file: home-assistant.env
    networks:
      home-assistant:
      
 # nodered:
 #   container_name: nodered
 #   image: nodered/node-red
 #   ports:
 #     - "1880:1880"
 ##   volumes:
  #    - ./nodered:/data
  #  depends_on:
  #    - home-assistant
  #    - mosquitto
  #  restart: unless-stopped
   # env_file: home-assistant.env
  #  networks:
  #    home-assistant:
      
  mosquitto:
    image: eclipse-mosquitto
    container_name: mosquitto
    restart: unless-stopped
    ports:
      - "1883:1883"
    volumes:
      - ./mosquitto/config:/mosquitto/config
      - ./mosquitto/data:/mosquitto/data
      - ./mosquitto/log:/mosquitto/log
    user: "${PUID}:${PGID}"
    env_file: home-assistant.env
    networks:
      home-assistant:
      
  #home-assistant-configurator:
  ##  image: "causticlab/hass-configurator-docker:x86_64"
   # container_name: home-assistant-configurator
  #  restart: unless-stopped
  #  ports:
  #    - "3218:3218/tcp"
  #  depends_on:
  #    - home-assistant
  #  volumes:
  #    - ./configurator-config:/config
  #    - ./home-assistant-config:/hass-config
  #  user: "${PUID}:${PGID}"
  #  env_file: home-assistant.env
   # networks:
   #   home-assistant:

networks:
  swag:
    external: true
  #macvlan0:
   # external: true
  home-assistant:
